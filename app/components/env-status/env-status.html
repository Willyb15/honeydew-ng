<div ng-attr-id="{{ EnvStatus.app }}" class="env-status table-responsive">

  <table class="table table-hover">
    <thead>
      <tr>
        <th>{{ EnvStatus.app }}: env</th>
        <th>healthcheck</th>
        <th>honeydew</th>
        <th ng-if="EnvStatus.isSharecare()">kabocha</th>
      </tr>
    </thead>
    <tbody>

      <tr ng-repeat-start="(name, app) in EnvStatus.statuses"
          ng-click="app.detailedView = !app.detailedView">
        <td class="env">
          <a target="_blank" ng-href="{{app.url}}">
            <span>{{ ::name.split(',')[1] }}</span>
          </a>
        </td>

        <td class="branch">
          ({{ app.build.branch ? app.build.branch : app.build.webpub }})
        </td>

        <td class="healthcheck">
          <status-button status="app.healthcheck.summary"></status-button>
        </td>
        <td class="honeydew">
          <div class="dropdown">

            <a ng-href="#" class="dropdown-toggle" data-toggle="dropdown">
              <status-button status="app.honeydew.summary"></status-button>
            </a>

            <div class="dropdown-menu healthcheck-popover" role="menu">
              <div>
                <a target="_blank"
                   ng-href="{{ app.honeydew.url }}">dashboard.</a>
              </div>
              <div>
                <span class="honeydew-details">
                  {{ app.honeydew.success }} successes; {{ app.honeydew.total }} total.
                </span>
              </div>
            </div>

          </div>
        </td>
        <td ng-if="EnvStatus.isSharecare()">
          <a target="_blank" ng-href="{{ app.kabocha.url }}">
            <status-button status="app.kabocha.summary"></status-button>
          </a>
        </td>
      </tr>

      <tr ng-if="app.detailedView"
          ng-repeat-end>
        <td env-status-detail
            name="{{ EnvStatus.app }}"
            app="::app">
        </td>
      </tr>

    </tbody>
  </table>

</div>
