<accordion><accordion-group heading="Logging in to Sharecare">

<p>To log in to Sharecare, use the following snippet. The examples table
is optional.</p>

<pre><code> Scenario: Quick Login
 Given I am logged in on the /topics page

 Examples:
 | email_address | password |
 | your@email.com  | 123123123 |
</code></pre>

<p>Using the above snippet, you will be immediately logged in on the
destination page without having to waste time at /header, or /login,
or at your profile page, if it's loading slowly. You can get directly
to your destination with this rule.</p>

<pre><code> Scenario: Login
 Given I am on the /header page
   When I log in as an example user

 Examples:
 | email_address | password |
 | your@email.com  | 123123123 |
</code></pre>

<p>If you don't use an examples table, Honeydew will automatically log
you in to <samp>qa-subject@sharecare.com</samp>, which is an account
that exists on QA, Stage, and Prod. It uses the SSO API to obtain an
authenticaton token, courtesy of Jay Heinlein :D, avoiding slow and
error prone issues at the /login page.</p>

<p>It also places the user's profile url into $myProfileUrl. For example,
my $myProfileUrl might be</p>

<pre><code>http://www.qa.sharecare.com/user/daniel-gempesaw-6.
</code></pre>

<p>You can use it in rules like</p>

<pre><code> Given I am on the $myProfileUrl page
 Given I am on the $myProfileUrl/settings page
</code></pre>

<h4>Logging in to Dot Mil environments</h4>

<pre><code> Scenario: Dot Mil Login
 Given I am logged in to .mil on the / page

 Examples:
# for test users:
 | id        | password  |
 | test.user | 123123123 |

# for ako accounts:
 | akoId       | password  |
 | your.ako.id | 123123123 |
</code></pre>

<p>Use the above snippet to log in to any of our .mil environments. Using
your own AKO account to log into Test/Prod depends directly on the
Example saying <code>akoId</code> so make sure to include it!</p>

<p>Like above, you get $myProfileUrl in the scope of your test for
free. It decides what to do based on using a specific hostname:</p>

<ul>
<li>https://armyfit.dev.sharecare.com</li>
<li>https://armyfit.stage.sharecare.com</li>
<li>https://test.armyfit.army.mil</li>
<li>BROKEN: https://armyfit.army.mil</li>
<li>https://ultimateme.dev.sharecare.com</li>
<li>BROKEN: https://ultimateme.stage.sharecare.com</li>
<li>BROKEN: https://armyfit.army.mil/UltimateMe</li>
</ul>

<p>N.B.: Currently, some of the login flows are broken. Sorry for the
inconvenience.</p>

</accordion-group><accordion-group heading="Logging out of Sharecare">

<p>Use the following rule to log out of Sharecare:</p>

<pre><code>  Then I log out of Sharecare
</code></pre>

<p>It just goes to the /logout page - for example, on Stage, it would
navigate to http://www.stage.sharecare.com/logout. We cannot simply
clear cookies because they are often managed on a different domain,
and Honeydew can only clear cookies for the current domain. There is
no guarantee that the browser would be on the right domain when we
tried clearing cookies.</p>

</accordion-group><accordion-group heading="Using the Interactive REPL">

<p>Put the following rule anywhere in your test:</p>

<pre><code> When I set a breakpoint
</code></pre>

<p>When the test reaches this point, it will stop and wait for your
input. While in REPL mode, you can use the following keyboard
shortcuts while your cursor is in the editor</p>

<ul>
<li><code>Alt-Enter</code> or <code>Cmd-Enter</code>: try out the current rule at point</li>
<li><code>Alt-Escape</code> or <code>Cmd-Escape</code>: exit the REPL and resume normal tests.</li>
</ul>

<p>You can also test out your selectors after using a breakpoint. Simply
put them right on the line, no <code>Givens</code>, <code>Whens</code>, or <code>Thens</code> needed:</p>

<pre><code> css=div.testing-selector
</code></pre>

<p>Honeydew will quickly search for your element and if it finds it, it
will pulse red for a second.</p>

<p>N.B.: If you're using Chrome and your DevTools console is open, it
will not work! The DevTools console conflicts with Honeydew, so you
may want to open up two browsers to the same page, or just use
Firefox, where it does work with an open console.</p>

</accordion-group><accordion-group heading="Copying and pasting? Try using examples instead">

<p>Any time you find yourself copying and pasting rules, you can probably
save yourself time by using an examples table. The examples table will
run the scenario once for each row of examples. If you don't need the
page to be loaded every time, load the page in a different scenario
from your examples scenario.</p>

<pre><code> Scenario: 1 load the page
 Given I am on the / page

 Scenario: verify elements
     Then the css=&lt;element&gt; element should be present

 Examples:
 | element |
 | #item1  |
 | #item2  |
 | #item3  |
</code></pre>

</accordion-group><accordion-group heading="Working with elements">

<h4>Text in an element</h4>

<pre><code> Then the id=element contains the text TextOnPage
</code></pre>

<h4>Clicking an element</h4>

<pre><code> When I click on the link css=#element
</code></pre>

<h4>Type into a text field</h4>

<pre><code> When I input I want to type this into the input field css=input
</code></pre>

<h4>Clear existing value in a text field</h4>

<pre><code> When I reset the input field css=input
</code></pre>

<h4>Precisely N elements of a certain type</h4>

<pre><code> Then there should be exactly 2 of css=div[id]
</code></pre>

<h4>Assert CSS rules for an element</h4>

<pre><code> Then the class=follow-button element should have the css background-color:rgba(250, 250, 250, 1)
</code></pre>

</accordion-group><accordion-group heading="Waiting: elements, text, AJAX, animations">

<h4>Waiting for Elements and Text</h4>

<p>Use the following rule to check for text anywhere in the
<samp>body</samp> tag:</p>

<pre><code> Then I wait for the text (.*) to be present
</code></pre>

<p>This is not very specific, as it checks the entire page. You can wait
for a specific element to contain text like this:</p>

<pre><code> Then I wait for the css=div.locator:contains('text') element to be present
</code></pre>

<p>Without the contains, you can just wait for an element to be present.</p>

<pre><code> Then I wait for the css=div.locator element to be present
</code></pre>

<h4>Waiting for AJAX and animations to complete</h4>

<p>We've re-implemented the <samp>click and wait</samp> rule to handle
cases where the click sends off an AJAX requests or triggers an
animation. In those cases, Honeydew will check via javascript if there
are any unfinished AJAX requests or animated elements before
continuing the script.</p>

<pre><code> When I click and wait on the link id=ajax-animation
</code></pre>

<h4>Waiting vs Pausing</h4>

<p>Pausing, while easy, is unreliable and leads to either slow or flaky
tests. If you pause for too long, your test will be slow. If you don't
pause long enough, your test will fail whenever anything causes the
test to run slowly (Saucelabs, internet connection, slow Honeydew box,
... many factors!). Instead, explicitly wait for the thing you want to
interact with. You can wait for elements and text to be present in the
above section. See the below section to wait for AJAX or animations to
finish.</p>

</accordion-group><accordion-group heading="Forms: Input">

<p>Input text into fields:</p>

<pre><code> When I input firstName into the input field css=input[type="text"]
 When I input a random e-mail address into the input field css=input[type="text"]
 When I input random text into the input field css=input[type="text"]
 When I input a timestamp into the input field css=input[type="text"]
</code></pre>

<p>Select things from a dropdown:</p>

<pre><code> When I select United States from the css=select dropdown
</code></pre>

<p>If the <samp>select</samp> is hidden, Honeydew can't click on
it. You'll have to click on the replacement items:</p>

<pre><code> When I click on the button css=.dropdown-arrow
 When I click on the link link_text=United States
</code></pre>

</accordion-group><accordion-group heading="Omniture and Comscore">

<h4>Normal Omniture Tags</h4>

<p>Omniture tags can be checked using the following template.</p>

<pre><code> Scenario: check omniture tags

     Then the omniture request should include &lt;tag&gt;=&lt;value&gt;

 Examples:
 | tag      | value
 | s.events | event4
 | events   | event4
 | s.eVar1  | index
 | eVar1    | index
 | v1       | index
 | s.prop8  | unregistered
 | prop8    | un.*
</code></pre>

<p>The <tag> can be in any of the following formats:</p>

<ul>
<li><code>eVar1</code>   - the most readable format; use this one if possible</li>
<li><code>s.eVar1</code> - the old format used for javascript variables</li>
<li><code>v1</code>      - query parameter format, this matches the actual request param</li>
</ul>

<h4>Comscore Tags</h4>

<p>The rule for checking ComScore tags is very similar:</p>

<pre><code> Scenario: check comscore tags

     Then the comscore request should include &lt;tag&gt;=&lt;value&gt;

 Examples:
 | tag  | value
 | c1   | 2
</code></pre>

<p>Unlike the omniture request, there is no leeway for the formats
of the <tag>. It must exactly match the query parameter name - <code>c1</code>,
<code>c2</code>, etc.</p>

<h4>Omniture Events</h4>

<p>If your omniture event is on a link that would take you to a new page,
use the following rule to stay on the page:</p>

<pre><code> When I trigger the omniture onClick event for the css=.omniture-element
</code></pre>

<p>Honeydew will click the link and keep you on the same page, and
afterwards in a new scenario you can check your omniture tags from the
event that was just fired. If the event is on a link that doesn't
redirect you, just use the normal <samp>click</samp> rule:</p>

<pre><code> When I click on the link css=.omniture-element
</code></pre>

</accordion-group><accordion-group heading="Comparing text and attributes (variables!)">

<p>You can store text or attributes in variables.</p>

<pre><code> When I store the inner text of the css=div.elem element as $innerText
 When I store the href attribute of the css=a.login element as $attribute
</code></pre>

<p>You can compare your variables later on: use <samp>the same as</samp>
or <samp>different from</samp> to compare.</p>

<pre><code> Then the inner text of the css=a.elem element should be the same as $innerText
 Then the href attribute of the a.signUp element should be different from $attribute
</code></pre>

<p>You can also run arbitrary javascript and save the result:</p>

<pre><code> When I set $myVarable = "return [1, 2, 3, 4, 5].reduce(function(a, b) {return a + b;});"
</code></pre>

<p>You need to <samp>return</samp> as the last thing in your javascript,
or else nothing will get stored into $myVariable.</p>

</accordion-group><accordion-group heading="Other ways to find elements">

<p>The most common method of finding elements is CSS selectors. There is
more information available on the
<a href="https://arnoldmedia.jira.com/wiki/display/QA/CSS+Selectors+And+You">QA wiki</a>.</p>

<pre><code>&lt;a id="unique" class="notUnique" name="email"&gt;Log In&lt;/a&gt;
</code></pre>

<p>If you're clicking on the above element, your other options include:</p>

<pre><code>class=notUnique
id=unique
link_text=Log In
tag_name=a
name=email
css=a[class^="not"]    # starts with
css=a[class*="Uni"]    # anywhere in the attribute
css=a[class$="que"]    # ends with
</code></pre>

<h4>Pseudo Selectors</h4>

<p>We've also included a few pseudo selectors in Honeydew that you can use:</p>

<ul>
<li>:visible - filters by is_displayed</li>
<li>:contains('text') - filters by text, implies :visible</li>
<li>:random - picks any element that matches</li>
</ul>

<p>These can be chained in any order:</p>

<pre><code>css=.many:visible:random
css=.many:contains('Hello'):random
css=ul.list li:random:visible
</code></pre>

</accordion-group><accordion-group heading="Alerts, confirmations, and prompts">

<p>If you have to interact with javascript <samp>alert</samp>,
<samp>confirm</samp>, or <samp>prompt</samp>, you have to make sure to
handle them immediately after they come up. If an alert is up,
Honeydew will fail if you do anything besides handling the alert.</p>

<p>If you need additional functionality (send text to a
<samp>prompt</samp> or get the text of an <samp>alert</samp>, please
get in touch and we can add it in.)</p>

<pre><code> Then I confirm the alert
 Then I dismiss the alert
</code></pre>

</accordion-group><accordion-group heading="Preamble Options">

<h4>Existing Bugs</h4>

<p>If there is already an existing open bug ticket for the feature you
are working on, and you know that the feature will fail, you can tell
Honeydew about it by using the <samp>Existing Bug</samp> preamble
option as follows:</p>

<pre><code>Feature: an existing jira ticket bug
Existing Bug: SC-10000
</code></pre>

<p>If the feature passes, nothing different will happen, but if the
feature fails, instead of being reported as a <samp>Failure</samp>,
it's status will be <samp>Bugged</samp>, which will show up black on
the Dashboard.</p>

<h4>Email Notifications</h4>

<p>To have a feature email you when it fails, add the following line to
the preamble:</p>

<pre><code>Feature: an email feature
Email: your@email.com
</code></pre>

<p>As long as the <samp>Email</samp> line is after <samp>Feature</samp>
and before <samp>Scenario</samp>, it will send you an email every time
the feature fails.</p>

<h4>Subtitles</h4>

<p>Subtitles will show at the bottom of the browser, and you can decide
how long the test should pause to let you read the subtitle. 2 seconds
is a good amount.</p>

<pre><code>Feature: read subtitles of the rules
Subtitles: 2
</code></pre>

<h4>Keep Open</h4>

<p>If you put <samp>Keep Open</samp> in the preamble, the browser will
not close if a rule fails or if the test runs to completion.</p>

<pre><code>Feature: keep the browser open
Keep Open
</code></pre>

<h4>Global Variables</h4>

<p>Similar to how you can set variables for use in rules, you can define
your own custom variables in the preamble that will be visible to the
all of the Scenarios in the file.</p>

<pre><code>Feature: use variables
$home = 'http://www.sharecare.com'
$away = 'https://armyfit.army.mil'

 Scenario: go to homepage
 Given I am on the $home page
</code></pre>

<h4>SScenarios</h4>

<p>During test debugging or authoring, you may want to only run only a
specific scenario instead of the entire script to save time. You can
do this by putting an extra 's' in front of the Scenario like such:</p>

<pre><code> Scenario: this will be skipped now
     Then I wait 50 years for the css=never element to be present

 sScenario: Only this scenario will run
 Given I am on the /wonderful page
</code></pre>

<p>In the above example, only the second scenario will be run. If multiple
scenarios have the "sScenario", they will all run, as expected.</p>

<h4>User Agent</h4>

<p>You can specify a device and the browser will masquerade as that
device by doing two things: first, setting the user agent to match
that device, and second, resizing the browser window as close as
possible to match your device.</p>

<pre><code>Feature: pretend to be ipad
Agent: ipad
</code></pre>

<p>By default, the device will use the portrait dimensions; you can use
the landscape dimensions by specifying <code>landscape</code>.</p>

<pre><code>Feature: pretend to be landscape ipad
Agent: landscape ipad
</code></pre>

<p>Your options for devices are:</p>

<pre><code>Agent: iphone
Agent: ipad
Agent: ipad_seven
Agent: android_phone
Agent: android_tablet
</code></pre>

<p>The resolution &amp; user agent definitions for these devices can be found
in the <a href="https://github.com/gempesaw/Selenium-UserAgent/blob/master/lib/Selenium/devices.json">project's Github repo</a>.</p>
</accordion>